<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Simple JSON</title>

    <!-- Bootstrap -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">

	<!-- datatables -->
	<link rel="stylesheet" href="https://cdn.datatables.net/1.10.4/css/jquery.dataTables.min.css">	

	<!-- class styles -->
	<link rel="stylesheet" href="../css/csci343.css">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- custom local styles -->
    <style>
    	.row { margin-bottom: 10px;}
	</style>

  	</head>
  	<body>
		<div class='container'>
			<h3 id='title'>Load Count 0</h3>
			<div class="row"/>
				<div class="col-md-12">
					<table id="eeTable" class="display" cellspacing="0" width="100%">
				        <thead>
				            <tr>
				                <th>First Name</th>
				                <th>Last Name</th>
				            </tr>
				        </thead>

				        <tbody>
				        </tbody>	    
				    </table>
				</div>
			</div>
		    <div class="row">
		    	<div class="col-md-12">
			    	<button id="load" class="btn btn-info">Get Data</button>
			    	<button id="clear" class="btn btn-info">Clear Data</button>
			    </div>			
			</div>
		</div>


		<!-- jquery -->
		<script src="https://code.jquery.com/jquery-1.11.2.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>	

		<!-- datatables -->	
		<script src="https://cdn.datatables.net/1.10.4/js/jquery.dataTables.min.js"></script>	

		<!-- class scipts -->
		<script src="../js/csci343.js"></script>	
		
		<!-- custom local javascript -->
		<script>
			var loadCount = 0;
			var xmlhttp = new XMLHttpRequest();
			var url = "http://enterprise.cs.mcla.edu/mcohen/simpleJSON.php";

			$(document).ready(function() 
			{
			    $('#eeTable').dataTable( {
			    	"searching": false,
			        "paging":   false,
			        "ordering": true,
			        "info":     false
			    } );
			} );

			xmlhttp.onreadystatechange=function() 
			{				
			    if (xmlhttp.readyState == 4 && xmlhttp.status == 200) 
			    {			    	
			        loadData(xmlhttp.responseText);
			    }
			}

			function loadData(response) 
			{
			    var obj = JSON.parse(response);
			    for (var i = 0; i < obj.employees.length; i++)
			    {
			    	var first = obj.employees[i].firstName;
			    	var last = obj.employees[i].lastName;
					$('#eeTable').DataTable().row.add( [first, last] ).draw();
			    };
			    loadCount++;
			    $('#title').text('Load Count ' + loadCount);
			}

			$('#load').click(function () 
			{				
				xmlhttp.open("GET", url, true);
				xmlhttp.send();				
			});

			$('#clear').click(function () 
			{
				$('#eeTable').DataTable().clear().draw();
			});

		</script>
	</body>
</html>